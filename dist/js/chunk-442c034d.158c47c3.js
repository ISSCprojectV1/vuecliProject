(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-442c034d"],{8237:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{width:"100%",height:"800px"}},[a("h2",{staticClass:"red"},[e._v(" 监管与服务任务 ")]),a("div",{staticClass:"block",staticStyle:{height:"80px","text-align":"left"}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"监管与服务地区"}},[a("el-select",{attrs:{placeholder:"请选择监管省份"},model:{value:e.serve_place,callback:function(t){e.serve_place=t},expression:"serve_place"}},[a("el-option",{attrs:{label:"青岛",value:"1"}}),a("el-option",{attrs:{label:"上海",value:"2"}}),a("el-option",{attrs:{label:"杭州",value:"3"}})],1),e._v(" 监管周期 "),a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.serve_timeRange,callback:function(t){e.serve_timeRange=t},expression:"serve_timeRange"}})],1),a("el-form-item",{attrs:{label:"监管种类"}},[a("el-select",{attrs:{placeholder:"请选择监管种类"},model:{value:e.serve_species,callback:function(t){e.serve_species=t},expression:"serve_species"}},[a("el-option",{attrs:{label:"钢铁",value:"1"}}),a("el-option",{attrs:{label:"棉花",value:"2"}}),a("el-option",{attrs:{label:"石油",value:"3"}}),a("el-option",{attrs:{label:"重金属",value:"4"}})],1),e._v(" 监管任务类型： "),a("el-select",{attrs:{placeholder:"请选择任务类型"},model:{value:e.serve_type,callback:function(t){e.serve_type=t},expression:"serve_type"}},[a("el-option",{attrs:{label:"信贷监管",value:"信贷监管"}}),a("el-option",{attrs:{label:"仓单监管",value:"仓单监管"}}),a("el-option",{attrs:{label:"质押权监管",value:"质押权监管"}}),a("el-option",{attrs:{label:"融资监管",value:"融资监管"}}),a("el-option",{attrs:{label:"主体查验",value:"主体查验"}}),a("el-option",{attrs:{label:"库存核实",value:"库存核实"}}),a("el-option",{attrs:{label:"报表审查",value:"报表审查"}}),a("el-option",{attrs:{label:"关联交易质押品审核",value:"关联交易质押品审核"}})],1)],1),a("el-button",{attrs:{type:"success"},on:{click:e.postAddress}},[e._v("立即创建")]),a("el-button",{attrs:{type:"info"},on:{click:e.abortForm}},[e._v("取消创建")])],1),a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"任务集",name:"taskTree"}},[e._v(" 任务分解情况（目前仅为单笔） "),a("div",{staticStyle:{width:"900px",height:"400px"},attrs:{id:"echartContainer"}})]),a("el-tab-pane",{attrs:{label:"监管联盟图",name:"graphTwo",lazy:""},on:{click:e.getMap}},[a("div",{staticStyle:{width:"900px",height:"600px"},attrs:{id:"container"}})])],1)],1)])},n=[],i=(a("99af"),a("b0c0"),a("b64b"),a("30d1")),o=a.n(i),s=a("0661"),r={name:"Time_granularity",components:{},mounted:function(){},data:function(){return{serve_place:"",serve_species:"",serve_timeRange:"",serve_type:"",activeName:"taskTree",isUpdatastrategy:!1,pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()},shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]}}},methods:{postAddress:function(){this.getData()},getData:function(){var e=this,t={name:this.serve_type,value:null,children:null};console.log("用户输入是："+t),Object(s["f"])(t).then((function(t){console.log(t.data.data[0]),0===t.data.data.length?e.$error("系统错误！请稍后重试！"):e.$message({type:"success",message:"任务分配已完成，请从下方查看分解情况。"}),e.drawLine(t.data.data[0])})).catch((function(){console.log("postTaskDecompositionApi fail")}))},drawLine:function(e){var t=this.$echarts.init(document.getElementById("echartContainer")),a=e;function l(e){"undefined"!=typeof e.seriesIndex&&"click"==e.type&&void 0!==e.value&&alert(e.name+"执行情况:  "+e.value)}t.setOption({tooltip:{trigger:"item",triggerOn:"mousemove"},series:[{type:"tree",id:0,name:"tree1",data:[a],top:"10%",left:"8%",bottom:"22%",right:"20%",symbolSize:15,edgeShape:"polyline",edgeForkPosition:"63%",initialTreeDepth:3,lineStyle:{width:2},itemStyle:{borderColor:"#6A5ACD"},label:{backgroundColor:"#fff",position:"left",verticalAlign:"middle",align:"right"},leaves:{label:{position:"right",verticalAlign:"middle",align:"left"}}}]}),t.on("click",l)},getData_map:function(){var e=this;Object(s["e"])().then((function(t){for(var a=t.data.data,l=[],n=[],i=Object.keys(a),o=0;o<i.length-2;o++){var s={};s.source=i[o],s.target=i[o+1],n.push(s)}for(var r=0;r<i.length;r++){var c={};c.id=i[r],c.label=i[r],c.agent=!1,l.push(c);var d=c.id;console.log("nodeaaaaaaaa"+r+":"+a[d]);for(var p=0;p<a[d][p];p++){var u={};u.id=a[d][p],u.label=a[d][p],u.agent=!0,l.push(u);var f={};f.source=d,f.target=u.id,n.push(f)}console.log("node"+r+":"+c.id)}e.getChart_map(l,n),e.$message({type:"success",message:"已形成联盟！"})})).catch((function(){console.log("getTaskApi fail")}))},getChart_map:function(e,t){console.log("刷新了这个页面-所以可以显示");var a={nodes:e,edges:t},l=new o.a.Tooltip({pageX:10,offsetY:20,getContent:function(e){var t=document.createElement("div");return t.style.width="180px",t.style.textAlign="left",t.innerHTML="\n      <h4>".concat(e.item.getModel().label,"</h4>\n      <ul>\n        <li>* 任务ID: ").concat(e.item.getModel().id,"</li>\n      </ul>\n      <ul>\n        <li>* 任务名称: ").concat(e.item.getModel().label,"</li>\n      </ul>\n"),t},itemTypes:["node"]}),n=document.getElementById("container").scrollWidth,i=document.getElementById("container").scrollHeight||500,s=new o.a.Graph({container:"container",width:n,height:i,fitView:!0,plugins:[l],modes:{default:["drag-canvas","drag-node"]},nodeStateStyles:{hover:{lineWidth:2,stroke:"#1890ff",fill:"#e6f7ff"}},layout:{type:"dagre",rankdir:"LR",align:"UL",controlPoints:!0,nodesepFunc:function(){return 1},ranksepFunc:function(){return 1}},defaultNode:{style:{radius:2,stroke:"#69c0ff",fill:a.nodes[2].ccc,lineWidth:1.5,fillOpacity:1},labelCfg:{style:{fill:"#595959",fontSize:20},offset:30},preRect:{show:!0,width:10,fill:"#40a9ff",radius:2},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:10,lineWidth:1,fill:"#72CC4A",stroke:"#72CC4A"}},defaultEdge:{type:"polyline",size:1,color:"#4169E1",style:{endArrow:{path:"M 0,0 L 8,4 L 8,-4 Z",fill:"#e2e2e2"},radius:10}}});s.node((function(e){return 1==e.agent?(console.log(e),{type:"circle",size:[100,80]}):0==e.agent?(console.log(e),{type:"modelRect",size:[270,80]}):{labelCfg:{offset:5}}})),s.data(a),s.render(),s.on("node:mouseenter",(function(e){var t=e.item;s.setItemState(t,"hover",!0)})),s.on("node:mouseleave",(function(e){var t=e.item;s.setItemState(t,"hover",!1)})),console.log("刷新了这个页面-页面结束")},handleClick:function(e,t){console.log(e,t),"graphTwo"==this.activeName&&this.getData_map()}}},c=r,d=a("2877"),p=Object(d["a"])(c,l,n,!1,null,"87bdcc4c",null);t["default"]=p.exports},b64b:function(e,t,a){var l=a("23e7"),n=a("7b0b"),i=a("df75"),o=a("d039"),s=o((function(){i(1)}));l({target:"Object",stat:!0,forced:s},{keys:function(e){return i(n(e))}})}}]);
//# sourceMappingURL=chunk-442c034d.158c47c3.js.map