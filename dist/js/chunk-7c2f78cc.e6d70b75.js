(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c2f78cc"],{2909:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var a=r("6b75");function i(t){if(Array.isArray(t))return Object(a["a"])(t)}r("a4d3"),r("e01a"),r("d28b"),r("a630"),r("e260"),r("d3b7"),r("3ca3"),r("ddb0");function n(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}var o=r("06c5");function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t){return i(t)||n(t)||Object(o["a"])(t)||l()}},6062:function(t,e,r){"use strict";var a=r("6d61"),i=r("6566");t.exports=a("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),i)},6566:function(t,e,r){"use strict";var a=r("9bf2").f,i=r("7c73"),n=r("e2cc"),o=r("0366"),l=r("19aa"),s=r("2266"),c=r("7dd0"),u=r("2626"),d=r("83ab"),f=r("f183").fastKey,h=r("69f3"),m=h.set,p=h.getterFor;t.exports={getConstructor:function(t,e,r,c){var u=t((function(t,a){l(t,u,e),m(t,{type:e,index:i(null),first:void 0,last:void 0,size:0}),d||(t.size=0),void 0!=a&&s(a,t[c],t,r)})),h=p(e),v=function(t,e,r){var a,i,n=h(t),o=b(t,e);return o?o.value=r:(n.last=o={index:i=f(e,!0),key:e,value:r,previous:a=n.last,next:void 0,removed:!1},n.first||(n.first=o),a&&(a.next=o),d?n.size++:t.size++,"F"!==i&&(n.index[i]=o)),t},b=function(t,e){var r,a=h(t),i=f(e);if("F"!==i)return a.index[i];for(r=a.first;r;r=r.next)if(r.key==e)return r};return n(u.prototype,{clear:function(){var t=this,e=h(t),r=e.index,a=e.first;while(a)a.removed=!0,a.previous&&(a.previous=a.previous.next=void 0),delete r[a.index],a=a.next;e.first=e.last=void 0,d?e.size=0:t.size=0},delete:function(t){var e=this,r=h(e),a=b(e,t);if(a){var i=a.next,n=a.previous;delete r.index[a.index],a.removed=!0,n&&(n.next=i),i&&(i.previous=n),r.first==a&&(r.first=i),r.last==a&&(r.last=n),d?r.size--:e.size--}return!!a},forEach:function(t){var e,r=h(this),a=o(t,arguments.length>1?arguments[1]:void 0,3);while(e=e?e.next:r.first){a(e.value,e.key,this);while(e&&e.removed)e=e.previous}},has:function(t){return!!b(this,t)}}),n(u.prototype,r?{get:function(t){var e=b(this,t);return e&&e.value},set:function(t,e){return v(this,0===t?0:t,e)}}:{add:function(t){return v(this,t=0===t?0:t,t)}}),d&&a(u.prototype,"size",{get:function(){return h(this).size}}),u},setStrong:function(t,e,r){var a=e+" Iterator",i=p(e),n=p(a);c(t,e,(function(t,e){m(this,{type:a,target:t,state:i(t),kind:e,last:void 0})}),(function(){var t=n(this),e=t.kind,r=t.last;while(r&&r.removed)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?"keys"==e?{value:r.key,done:!1}:"values"==e?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),u(e)}}},"6d61":function(t,e,r){"use strict";var a=r("23e7"),i=r("da84"),n=r("94ca"),o=r("6eeb"),l=r("f183"),s=r("2266"),c=r("19aa"),u=r("861d"),d=r("d039"),f=r("1c7e"),h=r("d44e"),m=r("7156");t.exports=function(t,e,r){var p=-1!==t.indexOf("Map"),v=-1!==t.indexOf("Weak"),b=p?"set":"add",g=i[t],y=g&&g.prototype,w=g,x={},S=function(t){var e=y[t];o(y,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(v&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return v&&!u(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(v&&!u(t))&&e.call(this,0===t?0:t)}:function(t,r){return e.call(this,0===t?0:t,r),this})};if(n(t,"function"!=typeof g||!(v||y.forEach&&!d((function(){(new g).entries().next()})))))w=r.getConstructor(e,t,p,b),l.REQUIRED=!0;else if(n(t,!0)){var k=new w,O=k[b](v?{}:-0,1)!=k,I=d((function(){k.has(1)})),j=f((function(t){new g(t)})),E=!v&&d((function(){var t=new g,e=5;while(e--)t[b](e,e);return!t.has(-0)}));j||(w=e((function(e,r){c(e,w,t);var a=m(new g,e,w);return void 0!=r&&s(r,a[b],a,p),a})),w.prototype=y,y.constructor=w),(I||E)&&(S("delete"),S("has"),p&&S("get")),(E||O)&&S(b),v&&y.clear&&delete y.clear}return x[t]=w,a({global:!0,forced:w!=g},x),h(w,t),v||r.setStrong(w,t,p),w}},7156:function(t,e,r){var a=r("861d"),i=r("d2bb");t.exports=function(t,e,r){var n,o;return i&&"function"==typeof(n=e.constructor)&&n!==r&&a(o=n.prototype)&&o!==r.prototype&&i(t,o),t}},bb2f:function(t,e,r){var a=r("d039");t.exports=!a((function(){return Object.isExtensible(Object.preventExtensions({}))}))},c3f9:function(t,e,r){"use strict";r.d(e,"c",(function(){return i})),r.d(e,"b",(function(){return n})),r.d(e,"a",(function(){return o}));var a=r("b775");r("4328");function i(t){return Object(a["a"])({method:"POST",data:t,url:"/usersupport"})}function n(t){return Object(a["a"])({method:"POST",data:t,url:"/userrelation"})}function o(t){return Object(a["a"])({method:"POST",data:t,url:"/tradesimilar"})}},e2be:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"diceng"}},[r("h2",[t._v("交易关联查询")]),r("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formInline}},[r("el-form-item",{attrs:{label:"查询商品"}},[r("el-select",{attrs:{placeholder:"选择商品"},model:{value:t.formInline.itemid,callback:function(e){t.$set(t.formInline,"itemid",e)},expression:"formInline.itemid"}},[r("el-option",{attrs:{label:"棉花U001",value:"1"}}),r("el-option",{attrs:{label:"钢铁U730",value:"2"}})],1)],1),r("el-form-item",{attrs:{label:"查询时间"}},[r("el-date-picker",{attrs:{type:"monthrange","range-separator":"至","start-placeholder":"开始月份","end-placeholder":"结束月份"},model:{value:t.formInline.time,callback:function(e){t.$set(t.formInline,"time",e)},expression:"formInline.time"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit(t.formInline)}}},[t._v("查询")])],1)],1),r("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"表格模式",name:"table"}},[r("h3",[t._v("用户关联分析表")]),r("el-table",{staticStyle:{width:"100%"},attrs:{"default-sort":{prop:"similarity",order:"descending"},data:t.SimilarityUser,stripe:""}},[r("el-table-column",{attrs:{prop:"uid1",label:"关联用户id","min-width":"180"}}),r("el-table-column",{attrs:{prop:"uid2",label:"关联用户id","min-width":"180"}}),r("el-table-column",{attrs:{prop:"oid",label:"关联商品id","min-width":"180"}}),r("el-table-column",{attrs:{sortable:"",prop:"similarity",label:"用户关联度","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(t){return[r("el-progress",{attrs:{"stroke-width":10,percentage:t.row.similarity}})]}}])}),r("el-table-column",{attrs:{label:"关联交易"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-popover",{attrs:{placement:"left-start",trigger:"click",offset:"2000",width:"1000"},on:{"after-enter":function(r){return t.Tradesimilar(e.row)}}},[r("el-tabs",{on:{"tab-click":t.tabclick},model:{value:t.activeName1,callback:function(e){t.activeName1=e},expression:"activeName1"}},[r("el-tab-pane",{attrs:{label:"交易关联分析表",name:"table1"}},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.SimilarityTrade,stripe:"","default-sort":{prop:"similarity",order:"descending"}}},[r("el-table-column",{attrs:{prop:"tid1",label:"关联交易id","min-width":"180"}}),r("el-table-column",{attrs:{prop:"tid2",label:"关联交易id","min-width":"180"}}),r("el-table-column",{attrs:{sortable:"",prop:"similarity",label:"交易关联度","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(t){return[r("el-progress",{attrs:{"stroke-width":10,percentage:t.row.similarity}})]}}],null,!0)})],1)],1)],1),r("el-button",{attrs:{slot:"reference"},slot:"reference"},[t._v("点击查看")])],1)]}}])})],1),r("el-pagination",{ref:"pagination",staticStyle:{"text-align":"center"},attrs:{background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":t.pageChange}})],1),r("el-tab-pane",{attrs:{label:"关系图模式",name:"diagram"}},[r("h3",[t._v("用户关联图")]),r("div",{directives:[{name:"show",rawName:"v-show",value:t.showing1,expression:"showing1"}],staticStyle:{width:"700px",height:"700px","text-align":"center"},attrs:{id:"echart2"}})])],1)],1)},i=[],n=(r("d81d"),r("fb6a"),r("b0c0"),r("d3b7"),r("6062"),r("3ca3"),r("ddb0"),r("2909")),o=r("c3f9"),l=r("313e"),s=r.n(l),c={name:"relationQuery",data:function(){return{activeName:"table",activeName1:"table1",formInline:{itemid:"",time:[]},supportData:[],SimilarityUser:[],SimilarityTrade:[],showing1:!1,echart1:"",echart2:"",echart3:"",total:1,echartOption:""}},mounted:function(){var t=document.getElementById("diceng");t.style.height=window.innerHeight+"px";document.getElementById("announcement")},methods:{tabclick:function(t){t.$options.propsData.label},pageChange:function(){},drawecharts1:function(t){for(var e=[],r=[],a=1;a<t.length;a++){for(var i=t[a][0],n=0,o=1;o<t[a].length;o++)n+=t[a][o];r.push({name:i,value:n})}for(var l=0;l<t.length-1;l++)e.push({type:"line",smooth:!0,seriesLayoutBy:"row"});e.push({type:"pie",id:"pie",radius:"30%",center:["66%","25%"],tooltip:{trigger:"item",showContent:!0},label:{formatter:"{b}: {@[1]} ({d}%)"},encode:{itemName:"users",value:[1]}},{type:"pie",id:"pie2",radius:"30%",tooltip:{trigger:"item",showContent:!0},center:["33%","25%"],label:{formatter:"{b}: {c} ({d}%)"},data:r}),this.echart1=s.a.init(document.querySelector("#echart1"));var c={legend:{},tooltip:{trigger:"axis",showContent:!0},dataset:{source:t},xAxis:{type:"category"},yAxis:{gridIndex:0},grid:{top:"55%"},series:e},u=this.echart1;this.echart1.on("updateAxisPointer",(function(t){var e=t.axesInfo[0];if(e){var r=e.value+1;u.setOption({series:{id:"pie",label:{formatter:"{b}: {@["+r+"]} ({d}%)"},encode:{value:r}}})}})),this.echart1.clear(),this.echart1.setOption(c)},drawechart2:function(t,e){this.echart2=s.a.init(document.querySelector("#echart2"));for(var r=[],a=0;a<t.length;a++)r.push(t[a].uid1,t[a].uid2);r=Object(n["a"])(new Set(r));for(var i=[],o=0;o<r.length;o++)i.push({name:"用户"+r[o]});for(var l=[],c=1;c<e.length;c++){for(var u=e[c][0],d=0,f=1;f<e[c].length;f++)d+=e[c][f];l.push({name:u,value:d})}console.log(i),console.log(l);for(var h=[],m=0;m<i.length;m++)for(var p=0;p<l.length;p++)i[m].name===l[p].name&&h.push({name:i[m].name,value:l[p].value,category:i[m].name});for(var v=[],b=0;b<t.length;b++)v.push({source:"用户"+t[b].uid1,target:"用户"+t[b].uid2,value:t[b].similarity/100,label:{show:!0,formatter:"关联度:{c}"},lineStyle:{width:10*t[b].similarity/100+1}});var g={tooltip:{},legend:[{data:i.map((function(t){return t.name}))}],animationDuration:1500,animationEasingUpdate:"quinticInOut",series:[{name:"Les Miserables",type:"graph",layout:"circular",symbolSize:function(t){return t+1},data:h,links:v,categories:i,roam:!0,focusNodeAdjacency:!0,itemStyle:{borderColor:"#fff",borderWidth:1,shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.3)"},label:{show:!0,position:"right",formatter:"{b} \n交易频次：{c}"},lineStyle:{color:"source",curveness:.3},emphasis:{lineStyle:{width:10}}}]};this.echart2.clear(),this.echart2.setOption(g)},drawecharts3:function(){for(var t=this.SimilarityTrade,e=[],r=[],a=0;a<t.length;a++)r.push(t[a].tid1,t[a].tid2);r=Object(n["a"])(new Set(r));for(var i=0;i<r.length;i++)e.push({name:"交易"+r[i]});for(var o=[],l=[],s=0;s<e.length;s++)o.push({name:e[s].name,category:e[s].name});for(var c=0;c<t.length;c++)l.push({source:"交易"+t[c].tid1,target:"交易"+t[c].tid2,value:t[c].similarity/100,label:{show:!0,formatter:"关联度:{c}"},lineStyle:{width:5*t[c].similarity/100+1}});this.echartOption={tooltip:{},legend:[{data:e.map((function(t){return t.name}))}],series:[{name:"Les Miserables",type:"graph",layout:"circular",data:o,links:l,categories:e,roam:!0,focusNodeAdjacency:!0,itemStyle:{borderColor:"#fff",borderWidth:1,shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.3)"},label:{show:!0,position:"right"},lineStyle:{color:"source",curveness:.3},emphasis:{lineStyle:{width:10}}}]}},init:function(){this.supportData=[],this.SimilarityTrade=[],this.SimilarityUser=[],""!=this.echart1&&this.echart1.clear(),""!=this.echart2&&this.echart2.clear(),""!=this.echart3&&this.echart3.clear()},prepareData:function(t,e){t[0],t[1];for(var r=t[0].getFullYear(),a=t[1].getFullYear(),i=t[0].getMonth(),n=t[1].getMonth(),o=12*(a-r)+(n-i)+1,l=["users"],s=r,c=i+1,u=0;u<o;u++)13==c&&(s+=1,c=1),l.push(s+"."+c),c+=1;var d=[];d.push(l);for(var f=0;f<e.length;f++){d.push(["用户"+e[f].uid]);for(var h=0;h<o;h++)d[f+1].push(0);for(var m=0;m<e[f].relationtrades.length;m++){var p=new Date(e[f].relationtrades[m].date).getMonth()-i+1;d[f+1][p]+=1}}return console.log(d),d},onSubmit:function(t){var e=this;this.init(),this.showing1=!0;var r={itemid:t.itemid,start:t.time[0],end:t.time[1]};Object(o["c"])(r).then((function(a){console.log(a.data.data),e.supportData=a.data.data;var i=e.prepareData(t.time,a.data.data);Object(o["b"])(r).then((function(t){console.log(t.data.data),e.SimilarityUser=t.data.data,e.drawechart2(t.data.data,i)})).catch((function(t){console.log(t)}))})).catch((function(t){console.log(t)}))},Tradesimilar:function(t){var e=this;this.$nextTick((function(){e.activeName1="table1";var r={uid1:t.uid1,uid2:t.uid2,itemid:e.formInline.itemid,start:e.formInline.time[0],end:e.formInline.time[1]};Object(o["a"])(r).then((function(t){t.data.data.length<=10?e.SimilarityTrade=t.data.data:e.SimilarityTrade=t.data.data.sort((function(t,e){return e.similarity-t.similarity})).slice(0,10)})).catch((function(t){console.log(t)}))}))}},watch:{SimilarityTrade:{deep:!0,handler:function(t,e){this.echart3?t&&(console.log("更新值"),this.drawecharts3(),this.echart3.setOption(this.echartOption)):document.querySelector("#echart3")&&(this.echart3=s.a.init(document.querySelector("#echart3")))}}}},u=c,d=r("2877"),f=Object(d["a"])(u,a,i,!1,null,"edf5eccc",null);e["default"]=f.exports},f183:function(t,e,r){var a=r("d012"),i=r("861d"),n=r("5135"),o=r("9bf2").f,l=r("90e3"),s=r("bb2f"),c=l("meta"),u=0,d=Object.isExtensible||function(){return!0},f=function(t){o(t,c,{value:{objectID:"O"+ ++u,weakData:{}}})},h=function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!n(t,c)){if(!d(t))return"F";if(!e)return"E";f(t)}return t[c].objectID},m=function(t,e){if(!n(t,c)){if(!d(t))return!0;if(!e)return!1;f(t)}return t[c].weakData},p=function(t){return s&&v.REQUIRED&&d(t)&&!n(t,c)&&f(t),t},v=t.exports={REQUIRED:!1,fastKey:h,getWeakData:m,onFreeze:p};a[c]=!0}}]);
//# sourceMappingURL=chunk-7c2f78cc.e6d70b75.js.map